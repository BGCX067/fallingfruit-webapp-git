<!-- Wrapper -->
<div id="location_popup">

<!-- Types -->
<div id="type_list">
 <% @location.locations_types.each{ |d| %>
 <li>
 <%= d.type.name %>
 <% unless d.type.wikipedia_url.nil? or d.type.wikipedia_url.strip == "" %>
  <a href="<%= d.type.wikipedia_url %>"><img class="type_icon" src="/wikipedia_icon.png"></a>
 <% end %>
 <% unless d.type.usda_symbol.nil? or d.type.usda_symbol.strip == "" %>
  <a href="http://plants.usda.gov/java/profile?symbol=<%= d.type.usda_symbol %>"><img class="type_icon" src="/usda_icon.png"></a>
 <% end %>
 </li>
 <% } %>
</div>

<!-- Description wrapper -->
<div id="description">

<!-- Quality -->
<% unless location.quality_rating.nil? or location.quality_rating.strip == "" %>
 <label>Quality</label> "<%= Location::Rating[location.quality_rating] %>" &nbsp; 
<% end %>

<!-- Yield -->
<% unless location.yield_rating.nil? or location.yield_rating.strip == "" %>
 <label>Yield</label> "<%= Location::Rating[location.yield_rating] %>"
<% end %>
<br/>

<!-- Season -->
<!-- (use ? to denote nil, brown out of season, green in season) -->
<% unless location.no_season or (location.season_start.nil? and location.season_stop.nil?) %>
 <label>Season</label>&nbsp;  <!-- to account for " of ratings -->
 <% current = Date.today.month.to_i - 1 
    season_class = "out_season"
    season_class = "in_season" if (current == location.season_start) or (current == location.season_stop)
    season_class = "in_season" if (!location.season_start.nil? and !location.season_stop.nil? and 
                                  current >= location.season_start and current <= location.season_stop)
    pretty_stop = location.season_stop.nil? ? "?" : Location::Months[location.season_stop]
    pretty_start = location.season_start.nil? ? "?" : Location::Months[location.season_start]
  %>
  <span class="<%= season_class %>">
  <%= pretty_start %> - <%= pretty_stop %>
  </span><br/>
<% end %>
 
<!-- Text Description -->
<!-- (keep <p> markup even if empty) -->
<p>
<% unless location.description.nil? %>
 <%= location.description.gsub("\n","<br>") %>
<% end %>
</p>

</div>  <!-- Description wrapper -->

<!-- Footer -->
<div id="footer">
 
 <!-- Controls -->
 <span id="controls"><a href="/locations/<%= location.id %>/edit">edit</a>
 <% if admin_signed_in? %>
  &nbsp; <%= link_to 'delete', location, method: :delete, data: { confirm: 'Are you sure?' } %>
 <% end %>
 &nbsp; <a href="/locations/<%= location.id %>">permalink</a>
 </span>
 
 <!-- Author -->
 <span id="added_by">by <i><%= location.author %></i>
 </span>
</div>

</div>  <!-- Footer -->

</div>  <!-- Wrapper -->
